import{c as Se,h as Me,i as we,j as Te,k as xe}from"./chunk-3O7OUCRD.js";import{a as H}from"./chunk-LOA2CKWM.js";import{b as j}from"./chunk-NSB2CLGN.js";import{a as z}from"./chunk-AQX3KV47.js";import{b as _e,c as ve}from"./chunk-CWKAQHZI.js";import{a as ye,b as Ce}from"./chunk-RILQHXYS.js";import{a as de,c as ue,d as pe}from"./chunk-YHHGV7YW.js";import{j as fe,l as he}from"./chunk-AQVF375O.js";import{Y as ge,ba as be}from"./chunk-SRQXZXE3.js";import{Ba as M,Da as G,Ia as Y,Ib as ne,Jb as _,Kb as v,Nb as oe,Ob as ae,Pb as T,Qb as a,Qc as ce,Rb as l,Sb as Q,Tb as B,Ub as A,Uc as $,Vb as R,Zb as N,ab as ee,bc as y,db as s,dc as p,ec as se,fa as J,fc as le,ha as K,hc as me,i as U,ic as F,ja as w,jc as q,lb as te,mb as u,oa as O,oc as x,pa as D,pc as k,qc as S,rc as m,tb as L,tc as V,ub as ie,vb as re,wa as P,xa as Z,xc as X,yc as E}from"./chunk-3VK5VDXH.js";function De(n,i){n&1&&R(0,"div",2)}var Pe=new K("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var Re=(()=>{class n{_elementRef=w(Y);_ngZone=w(Z);_changeDetectorRef=w(ce);_renderer=w(te);_cleanupTransitionEnd;constructor(){let e=ge(),t=w(Pe,{optional:!0});this._isNoopAnimation=e==="di-disabled",e==="reduced-motion"&&this._elementRef.nativeElement.classList.add("mat-progress-bar-reduced-motion"),t&&(t.color&&(this.color=this._defaultColor=t.color),this.mode=t.mode||this.mode)}_isNoopAnimation;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=ke(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=ke(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new P;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._cleanupTransitionEnd=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._transitionendHandler)})}ngOnDestroy(){this._cleanupTransitionEnd?.()}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(t){return new(t||n)};static \u0275cmp=L({type:n,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(t,r){t&2&&(ne("aria-valuenow",r._isIndeterminate()?null:r.value)("mode",r.mode),S("mat-"+r.color),k("_mat-animation-noopable",r._isNoopAnimation)("mdc-linear-progress--animation-ready",!r._isNoopAnimation)("mdc-linear-progress--indeterminate",r._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",$],bufferValue:[2,"bufferValue","bufferValue",$],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(t,r){t&1&&(B(0,"div",0),R(1,"div",1),_(2,De,1,0,"div",2),A(),B(3,"div",3),R(4,"span",4),A(),B(5,"div",5),R(6,"span",4),A()),t&2&&(s(),x("flex-basis",r._getBufferBarFlexBasis()),s(),v(r.mode==="buffer"?2:-1),s(),x("transform",r._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{--mat-progress-bar-animation-multiplier: 1;display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mat-progress-bar-reduced-motion{--mat-progress-bar-animation-multiplier: 2}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mat-progress-bar-track-height, 4px),var(--mat-progress-bar-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mat-progress-bar-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mat-progress-bar-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mat-progress-bar-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mat-progress-bar-track-height, 4px);border-radius:var(--mat-progress-bar-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{background-image:radial-gradient(circle, var(--mat-progress-bar-track-color, var(--mat-sys-surface-variant)) calc(var(--mat-progress-bar-track-height, 4px) / 2), transparent 0);background-repeat:repeat-x;background-size:calc(calc(var(--mat-progress-bar-track-height, 4px) / 2)*5);background-position:left;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering calc(250ms*var(--mat-progress-bar-animation-multiplier)) infinite linear}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse calc(250ms*var(--mat-progress-bar-animation-multiplier)) infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mat-progress-bar-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate calc(2s*var(--mat-progress-bar-animation-multiplier)) infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale calc(2s*var(--mat-progress-bar-animation-multiplier)) infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate calc(2s*var(--mat-progress-bar-animation-multiplier)) infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale calc(2s*var(--mat-progress-bar-animation-multiplier)) infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mat-progress-bar-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}
`],encapsulation:2,changeDetection:0})}return n})();function ke(n,i=0,e=100){return Math.max(i,Math.min(e,n))}var ot=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ie({type:n});static \u0275inj=J({imports:[be]})}return n})();var W=["cueElement"];function ft(n,i={}){return function(e,t,r){e.constructor.hasOwnProperty("__commandMap")||Object.defineProperty(e.constructor,"__commandMap",{value:new Map,enumerable:!1,configurable:!1,writable:!1}),e.constructor.__commandMap.set(n,{methodName:t,description:i.description??"",example:i.example??"",arguments:i.arguments??[]})}}var Ie=class n{constructor(i,e,t,r,C,g){this.route=i;this.themeService=e;this.router=t;this.hardwareService=r;this.dialog=C;this.supabaseService=g;this.setupCommands(),G(()=>{this.embedded==="embedded"&&(this.experimentConfig=this.formData(),this.generateCuesOnFormUpdate&&this.generateCues())}),G(()=>{if(this.stimuliMode()==="neurofeedback"){let d=this.hardwareService.evtKey();if(d){if(d===" ")this.showTrial(null);else{let b=Object.entries(this.stimulusCommandMap).find(([,o])=>o===d)?.[0];b&&this.showTrial(b)}this.hardwareService.evtKey.set("")}let f=this.hardwareService.evtConfig();if(f){let b=Array.from(f.trim().matchAll(/"([^"]+)"|'([^']+)'|[^\s]+/g)).map(h=>h[1]??h[2]??h[0]),o=b[0],c=b.slice(1);this.internalRegistry[o]&&this.internalRegistry[o].fn(...c),this.hardwareService.evtConfig.set("")}}})}formData=M({});embedded="fullwindow";stimulusCommandMap;stimulusMarkersMap;commandRegistry=new P;cuesIconElement;cuesSpanElement;cuesDivElement;onDelivery=M(!1);progressValue=M(0);countdownTimer=M("");stimuliMode=M("sequential");cues=M([]);countdownTimeoutId=null;countdownIntervalId=null;cancelStimuliSequence=null;startCountdownValue=5;fullWindowLink="";experimentConfig={};internalRegistry={};hasAdaptive=!1;generateCuesOnFormUpdate=!1;allModes=[{mode:"sequential",tooltip:"Stimuli follow a predefined or randomized sequence.",label:"Scheduled"},{mode:"neurofeedback",tooltip:"Stimuli are shown only in response to external input signals.",label:"Signal-Based"}];allowModes=["sequential","neurofeedback"];setupCommands(){let i=this.constructor.__commandMap||new Map;for(let[e,t]of i.entries()){let r=this[t.methodName];typeof r=="function"&&!this.internalRegistry[e]&&(this.internalRegistry[e]={fn:r.bind(this),description:t.description??"",example:t.example??"",arguments:t.arguments??""})}this.hasAdaptive=Object.keys(this.internalRegistry).length>0}ngOnInit(){this.loadConfigFromURL(),this.setWindow(),this.commandRegistry.emit(this.internalRegistry)}ngOnDestroy(){this.stopSequence()}ngAfterViewInit(){this.hardwareService.core.checkAvailableDevice()}setWindow(){if(this.embedded==="embedded")document.exitFullscreen&&document.exitFullscreen();else{let i=document.documentElement;i.requestFullscreen&&i.requestFullscreen()}}randomIntInRange(i){let e=i[0],t=i[1];return Math.floor(Math.random()*(t-e+1))+e}generateShuffledList(i){let e=Array.from({length:i},(t,r)=>r);for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}getRandomItems(i,e=1){let t=[...i].sort(()=>Math.random()-.5);return e===1?t[0]:t.slice(0,e)}generateCues(){}startCountdown(){this.supabaseService.getTierLevel(this.supabaseService.userTier())<this.supabaseService.getTierLevel("Pro")?this.dialog.open(Me,{data:{title:"Hardware Integration Restricted",message:"Access to device configuration is only available to users with a Pro or Enterprise plan.",confirmText:"Got it"}}).afterClosed().subscribe(()=>{this.startCountdown_()}):this.startCountdown_()}startCountdown_(){this.onDelivery.set(!0),this.hardwareService.writeLine('CMD=CLA;CMD=@LOG MESSAGE="Session start" COLOR=RED;');let i=sessionStorage.getItem("cteno-device-connection-port-ext");if(this.hardwareService.writeLine(`CMD=EXT CH=${i} ACTION=SETMODE MODE=DIGITAL_OUTPUT_MODE;`),this.startCountdownValue===0){sessionStorage.getItem("PermissionsToRun")==="true"?this.cancelStimuliSequence=this.runStimuliSequence():this.stopSequence();return}this.countdownTimeoutId=window.setTimeout(()=>U(this,null,function*(){this.countdownTimer.set(this.startCountdownValue),yield this.hardwareService.writeLine("CMD=@BIP FREQ=1000 DURATION=100 VOLUME=128;"),this.countdownIntervalId=window.setInterval(()=>U(this,null,function*(){let e=this.countdownTimer();e>1?(this.countdownTimer.set(e-1),yield this.hardwareService.writeLine("CMD=@BIP FREQ=1000 DURATION=100 VOLUME=128;")):(this.countdownIntervalId!==null&&(clearInterval(this.countdownIntervalId),this.countdownIntervalId=null),this.countdownTimer.set(""),this.countdownTimeoutId=window.setTimeout(()=>{sessionStorage.getItem("PermissionsToRun")==="true"?this.cancelStimuliSequence=this.runStimuliSequence():this.stopSequence()},1e3))}),1e3)}),1e3)}stopSequence(){this.countdownTimeoutId!==null&&(clearTimeout(this.countdownTimeoutId),this.countdownTimeoutId=null),this.countdownIntervalId!==null&&(clearInterval(this.countdownIntervalId),this.countdownIntervalId=null),this.cancelStimuliSequence?.(),this.cancelStimuliSequence=null,this.countdownTimer.set(""),this.onDelivery.set(!1),this.stopStimuliSequence(),this.setProgress(0)}shuffle(i){let e=[...i];for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}shufflePreservingParity(i){let e=i.filter((o,c)=>c%2===0),t=i.filter((o,c)=>c%2!==0);function r(o){for(let c=o.length-1;c>0;c--){let h=Math.floor(Math.random()*(c+1));[o[c],o[h]]=[o[h],o[c]]}return o}let C=r(e),g=r(t),d=[],f=0,b=0;for(let o=0;o<i.length;o++)d[o]=o%2===0?C[f++]:g[b++];return d}setProgress(i){this.progressValue.set(i),i>=99&&setTimeout(()=>{this.hardwareService.writeLine('CMD=@LOG MESSAGE="Session End" COLOR=RED;CMD=@BIP;')},3e3)}gotoFullWindow(){this.stopSequence();let i=btoa(JSON.stringify(this.experimentConfig)),e=btoa(JSON.stringify(this.stimulusCommandMap)),t=btoa(JSON.stringify(this.stimulusMarkersMap));this.router.navigate([this.fullWindowLink],{queryParams:{config:i,command:e,markers:t}})}loadConfigFromURL(){this.embedded!=="embedded"&&this.route.queryParams.subscribe(i=>{this.experimentConfig=JSON.parse(atob(i.config)),this.stimulusCommandMap=JSON.parse(atob(i.command)),this.stimulusMarkersMap=JSON.parse(atob(i.markers))}),this.cues().length==0&&this.generateCues()}generateFrequencies(i,e=5,t=70,r=-1){let C=Math.floor(i/e),g=[];for(let d=2;d<=C;d++){let f=i/d;f<=t&&g.push(f.toFixed(2))}return r>0&&g.length>r&&(g=g.slice(0,r)),g}selectstimuliMode(i){this.stimuliMode.set(i),this.generateTrials(),this.hardwareService.evtKey.set(""),this.hardwareService.evtConfig.set("")}fixClass(i){return i.replace(/ /g,"_")}propagateClassMarker(i){if(i===null)return;let e=this.stimulusMarkersMap[i],t=sessionStorage.getItem("cteno-device-connection-port-ext"),r=sessionStorage.getItem("cteno-device-connection-port-dac");this.hardwareService.writeLine(`CMD=MKR DC=${e.dc_value} DCCH=${r} IO=${e.io_duration} IOCH=${t};`)}onTrial(i){}isNeurofeedback(i){return this.stimuliMode()==="neurofeedback"}runStimuliSequence(){let i=this.generateTrials(),e=performance.now(),t=0,r=[],C=o=>{let c=e+i.slice(0,o).reduce((h,I)=>h+I.duration+I.soa,0);return Math.max(0,c-performance.now())},g=o=>{this.showTrial(o.class),this.onTrial(o),this.hardwareService.writeLine(`CMD=@LOG MESSAGE="Class: ${o.class}" COLOR=GREEN;`)},d=o=>{this.showTrial(null),t++,this.setProgress(100*t/i.length)},f=()=>{r.forEach(o=>window.clearTimeout(o)),r=[]},b=()=>{if(t>=i.length){f(),this.onDelivery.set(!1);return}let o=i[t],c=C(t),h=window.setTimeout(()=>{g(o);let I=window.setTimeout(()=>{d(o),b()},o.duration);r.push(I)},c);r.push(h)};return b(),f}static \u0275fac=function(e){return new(e||n)(u(de),u(z),u(ue),u(H),u(Se),u(j))};static \u0275dir=re({type:n,viewQuery:function(e,t){if(e&1&&me(W,5)(W,5)(W,5),e&2){let r;F(r=q())&&(t.cuesIconElement=r),F(r=q())&&(t.cuesSpanElement=r),F(r=q())&&(t.cuesDivElement=r)}},inputs:{formData:"formData",embedded:"embedded",stimulusCommandMap:"stimulusCommandMap",stimulusMarkersMap:"stimulusMarkersMap"},outputs:{commandRegistry:"commandRegistry"}})};var Ne=["*"],Fe=(n,i)=>i.mode;function qe(n,i){n&1&&(a(0,"button",7)(1,"mat-icon"),m(2,"lock"),l(),m(3," Upgrade to Enable Hardware Features "),l())}function Ve(n,i){if(n&1){let e=N();a(0,"button",14),y("click",function(){O(e);let r=p(3);return D(r.hardwareService.core.autoConnect())}),m(1),a(2,"mat-icon"),m(3,"usb_off"),l()()}if(n&2){let e=p(3);s(),V(" Auto-Connect to Hardware | ",e.hardwareService.connectionMode()," ")}}function Xe(n,i){if(n&1){let e=N();a(0,"button",14),y("click",function(){O(e);let r=p(3);return D(r.hardwareService.core.requestAndConnectDevice())}),m(1," Select Hardware to Connect "),a(2,"mat-icon"),m(3,"usb"),l()()}}function ze(n,i){if(n&1&&_(0,Ve,4,1,"button",13)(1,Xe,4,0,"button",13),n&2){let e=p(2);v(e.hardwareService.core.hasAvailableDevice()?0:1)}}function je(n,i){if(n&1&&(a(0,"button",12),m(1),a(2,"mat-icon"),m(3,"usb"),l()()),n&2){let e=p(2);s(),V(" Connected | ",e.hardwareService.connectionMode()," ")}}function He(n,i){if(n&1&&_(0,ze,2,1)(1,je,4,1,"button",12),n&2){let e=p();v(e.hardwareService.core.isConnected()?1:0)}}function Ue(n,i){if(n&1&&(a(0,"mat-button-toggle",16),m(1),l()),n&2){let e=p().$implicit;T("value",X(e.mode))("matTooltip",X(e.tooltip)),s(),V(" ",e.label," ")}}function Ge(n,i){if(n&1&&_(0,Ue,2,5,"mat-button-toggle",16),n&2){let e=i.$implicit,t=p(2);v(t.hostRef.allowModes.includes(e.mode)?0:-1)}}function Qe(n,i){if(n&1){let e=N();a(0,"mat-button-toggle-group",15),y("change",function(r){O(e);let C=p();return D(C.hostRef.selectstimuliMode(r.value))}),oe(1,Ge,1,1,null,null,Fe),l()}if(n&2){let e=p();T("value",e.hostRef.stimuliMode()),s(),ae(e.hostRef.allModes)}}function $e(n,i){n&1&&(a(0,"mat-icon",10),m(1,"point_scan"),l())}var Oe=class n{constructor(i,e,t){this.themeService=i;this.supabaseService=e;this.hardwareService=t}hostRef;showCrossBar=!0;static \u0275fac=function(e){return new(e||n)(u(z),u(j),u(H))};static \u0275cmp=L({type:n,selectors:[["app-stimuli-layout"]],inputs:{hostRef:"hostRef",showCrossBar:"showCrossBar"},ngContentSelectors:Ne,decls:27,vars:34,consts:[["matIconButton","","matTooltip","\u26A0\uFE0F Stop stimulus delivery",1,"stop","conditional-visible-b","top-left",3,"click"],["matIconButton","","matTooltip","\u26A0\uFE0F Starting will begin stimulus delivery",1,"start","conditional-visible-b","top-left",3,"click"],["matIconButton","","matTooltip","\u26A0\uFE0F Fullscreen will restart stimulus delivery",3,"click"],["matIconButton","","matTooltip","\u26A0\uFE0F Exiting fullscreen will restart stimulus delivery",3,"routerLink"],["matIconButton","","id","mode-light",3,"click"],["matIconButton","","id","mode-dark",3,"click"],[1,"bottom-left","flex-row","flex-row-center"],["matButton","filled","routerLink","/user"],["name","stimuliMode",3,"value"],[1,"center","counter",3,"innerHTML"],[1,"center","fixation"],["mode","determinate",3,"value"],["matButton","filled","disabled","",1,"connected"],["matButton","filled",1,"disconnected"],["matButton","filled",1,"disconnected",3,"click"],["name","stimuliMode",3,"change","value"],[3,"value","matTooltip"]],template:function(e,t){e&1&&(se(),a(0,"div")(1,"button",0),y("click",function(){return t.hostRef.stopSequence()}),a(2,"mat-icon"),m(3,"stop_circle"),l()(),a(4,"button",1),y("click",function(){return t.hostRef.startCountdown()}),a(5,"mat-icon"),m(6,"play_circle"),l()(),a(7,"button",2),y("click",function(){return t.hostRef.gotoFullWindow()}),a(8,"mat-icon"),m(9,"arrows_output"),l()(),a(10,"button",3)(11,"mat-icon"),m(12,"fullscreen_exit"),l()(),a(13,"button",4),y("click",function(){return t.themeService.setThemeMode("light")}),a(14,"mat-icon"),m(15,"light_mode"),l()(),a(16,"button",5),y("click",function(){return t.themeService.setThemeMode("dark")}),a(17,"mat-icon"),m(18,"dark_mode"),l()(),a(19,"div",6),_(20,qe,4,0,"button",7)(21,He,2,1),_(22,Qe,3,1,"mat-button-toggle-group",8),l(),Q(23,"span",9),_(24,$e,2,0,"mat-icon",10),le(25),Q(26,"mat-progress-bar",11),l()),e&2&&(S(E("screen ",t.hostRef.embedded)),k("light",t.themeService.mode()==="light")("dark",t.themeService.mode()==="dark"),s(),k("visible-b",t.hostRef.onDelivery()),s(3),k("visible-b",!t.hostRef.onDelivery()),s(3),S(E("bottom-right fullscreen ",t.hostRef.embedded)),s(3),S(E("bottom-right appscreen ",t.hostRef.embedded)),T("routerLink",X(t.hostRef.normalWindowLink)),s(3),S(E("top-right mode-button ",t.hostRef.embedded)),x("display",t.themeService.mode()==="dark"?"flex":"none"),s(3),S(E("top-right mode-button ",t.hostRef.embedded)),x("display",t.themeService.mode()==="dark"?"none":"flex"),s(4),v(t.supabaseService.getTierLevel(t.supabaseService.userTier())<t.supabaseService.getTierLevel("Pro")?20:21),s(2),v(t.hostRef.allowModes.length>1?22:-1),s(),T("innerHTML",t.hostRef.countdownTimer(),ee),s(),v(t.showCrossBar?24:-1),s(2),T("value",t.hostRef.progressValue()))},dependencies:[xe,we,Te,ve,_e,fe,Re,Ce,ye,pe,he],styles:[":root .light{--mat-button-toggle-text-color: #e3e2e6;--mat-button-toggle-background-color: transparent;--mat-button-toggle-selected-state-text-color: #dbe2f9;--mat-button-toggle-selected-state-background-color: #3f4759;--mat-button-toggle-label-text-line-height: 2.7}  :root .dark{--mat-button-toggle-text-color: #1b1b1f;--mat-button-toggle-background-color: transparent;--mat-button-toggle-selected-state-text-color: #131b2c;--mat-button-toggle-selected-state-background-color: #dbe2f9;--mat-button-toggle-label-text-line-height: 2.7}  :root{--mat-progress-bar-track-height: 6px;--mat-progress-bar-active-indicator-height: 6px}.start[_ngcontent-%COMP%], .stop[_ngcontent-%COMP%]{scale:2}.conditional-visible-b.visible-b[_ngcontent-%COMP%]{visibility:visible}.conditional-visible-b[_ngcontent-%COMP%]{visibility:hidden}.screen[_ngcontent-%COMP%]{background-color:var(--mat-sys-inverse-surface);overflow:hidden}.screen.embedded[_ngcontent-%COMP%]{position:relative;border-radius:var(--mat-sys-corner-large);width:100%;aspect-ratio:16/9;height:unset;box-sizing:border-box;border:2px solid var(--mat-sys-inverse-surface)}.screen.fullwindow[_ngcontent-%COMP%]{display:flex;width:100vw;height:100vh;align-items:center;justify-content:center}  .center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.counter[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);font:var(--mat-sys-body-small);font-size:12vh}.fixation[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);z-index:9999}.bottom-right[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);position:absolute;right:16px;bottom:16px}.bottom-left[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);position:absolute;left:16px;bottom:16px}.top-left[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);position:absolute;left:16px;top:16px}.top-right[_ngcontent-%COMP%]{color:var(--mat-sys-inverse-on-surface);position:absolute;right:16px;top:16px}.bottom-right[_ngcontent-%COMP%], .bottom-left[_ngcontent-%COMP%], .top-left[_ngcontent-%COMP%], .top-right[_ngcontent-%COMP%]{z-index:999}button.top-left[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], button.bottom-right[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:1em;height:1em}.stop[_ngcontent-%COMP%]{color:var(--mat-sys-error)}.fullscreen[_ngcontent-%COMP%]{display:none}.appscreen[_ngcontent-%COMP%], .fullscreen.embedded[_ngcontent-%COMP%]{display:block}.appscreen.embedded[_ngcontent-%COMP%]{display:none}.mode-button.embedded[_ngcontent-%COMP%]{display:none!important}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}button[_ngcontent-%COMP%]{z-index:1000}.disconnected[_ngcontent-%COMP%]{background-color:var(--mat-sys-error)!important;color:var(--mat-sys-on-error)!important}.connected[_ngcontent-%COMP%]{background-color:var(--mat-sys-inverse-primary)!important;color:var(--mat-sys-on-primary-container)!important}"]})};export{ot as a,ft as b,Ie as c,Oe as d};
